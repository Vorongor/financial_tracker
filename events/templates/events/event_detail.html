{% extends "includes/index.html" %}
{% block content %}

  {% if event %}
    <div class="container py-4">
    <div class="row g-4 d-flex justify-content-center gap-3">
      <div class="card bg-dark text-white shadow-sm mb-4">
        {% include "events/components/event_top.html" %}
      </div>

      <div class="card bg-dark text-white shadow-sm mb-4">
        {% include "events/components/event_info.html" %}
      </div>


      {% if current_budget %}
        <div class="card bg-dark text-white shadow-sm mb-4">
          <div class="card-body">
            <h5 class="text-secondary mb-4">Event Analytics</h5>
            {% if event.event_type == "Savings" %}
              <div class="row align-items-center">
                {% if savings_chart_data_json %}
                  <canvas id="savingsEventChart"
                          style="max-height: 360px;"></canvas>
                {% else %}
                  <p>Savings chart will be here</p>
                {% endif %}
              </div>
            {% elif event.event_type == "Accumulative" %}
              <div class="row align-items-center">
                <canvas id="accumulativeEventChart"
                        style="max-height: 360px;"></canvas>
              </div>
            {% else %}
              <div class="row align-items-center">
                <P>{{ event.start_date }} - {{ event.end_date }}</P>
                <canvas id="expensesChart"></canvas>
              </div>
            {% endif %}
          </div>
        </div>
      {% endif %}


      <div class="card bg-dark text-white shadow-sm mb-4">
        {% include "events/components/event_analytics.html" %}
      </div>
      <div class="d-flex flex-row justify-content- flex-wrap gap-3">
        <div class="card bg-dark text-white shadow-sm mb-4 flex-grow-1">
          {% include "events/components/event_transactions.html" %}
        </div>
        {% if event.accessibility != "Private" %}
          <div class="card bg-dark text-white shadow-sm mb-4 flex-grow-1">
            {% include "events/components/event_members.html" %}
          </div>
        {% endif %}
        {% if event.accessibility != "Private" %}
          <div class="card bg-dark text-white shadow-sm flex-grow-1">
            {% include "events/components/event_connects.html" %}
          </div>
        {% endif %}
      </div>

      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      {% include "events/components/script_event_detail.html" %}
      {% include "events/components/script_savings_chart.html" %}
      {% include "events/components/script_event_chart_expense.html" %}
      {% include "events/components/script_event_chart_accum.html" %}
    </div>


  {% else %}
    <h3>Oh, well</h3>
    <p>Seems like itâ€™s broken</p>
  {% endif %}
  {% include "modals/user_key_modal.html" %}
  {% include "modals/transaction_modal.html" %}
{% endblock %}
